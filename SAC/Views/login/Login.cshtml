
@{
    Layout = null;
}

<!DOCTYPE html>

<html>
<head>
    <meta name="viewport" content="width=device-width" />
    <title>Login</title>
    <link href="~/Content/bootstrap.min.css" rel="stylesheet" />
    <link href="~/Content/Site.css" rel="stylesheet" />
    <link href="~/Content/css/responsive-slider.css" rel="stylesheet">
    <link href="~/Content/css/animate.css" rel="stylesheet" />
    <link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.6.3/css/all.css" integrity="sha384-UHRtZLI+pbxtHCWp1t77Bi1L4ZtiqrqD80Kn4Z8NTSRyMA2Fd33n5dQ8lWUE00s/" crossorigin="anonymous">
    <link href="https://fonts.googleapis.com/css?family=Montserrat|Open+Sans|Roboto" rel="stylesheet">
</head>
<body>
    <div class="col-md-12 login-panel">
        @*<div class="col-md-8 hidden-sm hidden-xs wow fadeInDown">
            <img class="img-responsive center-block" src="~/Content/img/logo_paisas.svg" style="width:80%;" />
        </div>*@
        <div class="col-xs-12 col-sm-8 col-sm-offset-2 col-md-4 col-md-offset-4 wow fadeInUp" style="margin:2em">
            <div class="panel panel-default ">
                @*<div class="panel-heading text-center"></div>*@
                <div class="panel-body text-center"style="margin:2em;">
                    <img class="img-responsive center-block" src="~/Content/img/logo_paisas.svg" style="width:100%;" />
                    @*<i class="fas fa-user-secret " style="font-size:10em;margin-bottom:0.2em;color:darkgreen;font-weight:900;"></i>*@
                    <br>
                    <div class="input-group">
                        <span class="input-group-addon"><i class="fas fa-user-tie"></i></span>
                        <input type="text" id="usuario" class="form-control" placeholder="usuario" aria-describedby="basic-addon2">
                    </div>
                    <br>
                    <div class="input-group">
                        <span class="input-group-addon"><i class="fas fa-unlock"></i></span>
                        <input type="password" onkeypress="return runScript(event)" id="contraseña" class="form-control" placeholder="Contraseña" aria-describedby="basic-addon2">
                    </div>
                    <br>
                    <button class="btn btn-block btn-success" onclick="return Login() " style="background-color:darkgreen" id="btnLogin" type="button">Iniciar Sesión</button>
                </div>
            </div>
        </div>
    </div>


    <!-- Modal -->
    <div class="modal wow pulse" id="login" tabindex="200" role="dialog" aria-labelledby="exampleModalLabel" aria-hidden="true" style="margin-top:20vh">
        <div class="modal-dialog" role="document">
            <div class="modal-content text-center">
                <div class="modal-body">
                    <img src="~/Content/img/1481054780733836946.gif" style="width:50%" />
                    <div class="alert alert-info" id="alert-login" role="alert">Iniciado Sesión....</div>
                </div>
            </div>
        </div>
    </div>

    <script src="~/Scripts/js/wow.min.js"></script>
    <script src="~/Scripts/js/responsive-slider.js"></script>

    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js"></script>
    <script>
                var wow = new WOW({}).init();

                function runScript(e) {
                    if (e.keyCode == 13) {
                        Login();
                    }
                }
                function Login() {
                    var login = {
                        Usuario: $('#usuario').val(),
                        Contraseña: $('#contraseña').val(),
                    };

                    if (login.Usuario == "" && login.Contraseña == "") {
                        document.getElementById("usuario").focus();
                        return;
                    };
                    document.getElementById("alert-login").innerHTML = "Iniciado Sesión..."
                    $('#login').modal('show');

                    $.ajax({
                        url: "/Login/Login/",
                        contentType: "application/json;charset=UTF-8",
                        dataType: "json",
                        type: "POST",
                        data: JSON.stringify(login),
                        success: function (result) {
                            if (result == '1') {
                                  var returnUrl = "@Request.QueryString["ReturnUrl"]";

                                 if (returnUrl == "") {
                                     window.location.href = "@Url.Action("index", "sugerencias")";
                                 }
                                 else {
                                     window.location.href = returnUrl;
                                 }
                            }
                            else {
                               // alert("Usuario y/o password incorrectos"); 
                                sleep(2000);
                                $('#login').modal('toggle');
                                document.getElementById("usuario").value = "";
                                document.getElementById("contraseña").value = "";
                                document.getElementById("usuario").focus();
                            }
                        },
                        error: function () {
                            alert("ocurrio una falla, intente nuevamente!.");
                        }
                    });
        }

        function sleep(milliseconds) {
            var start = new Date().getTime();
            for (var i = 0; i < 1e7; i++) {
                if ((new Date().getTime() - start) > milliseconds) {
                    break;
                }
            }
        }
        function CerrarModal() {
            $('#login').modal('toggle');
        }

    </script>
</body>
</html>
